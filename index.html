<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MetaFit Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50 text-gray-800">

<!-- Navbar -->
<nav class="flex items-center justify-between p-4 bg-white shadow-md sticky top-0 z-50">
  <div class="text-2xl font-bold text-blue-600">MetaFit</div>
  <div class="hidden md:flex space-x-6 text-sm font-medium">
    <a href="./Pages/meal.html" class="hover:text-blue-500">Meals</a>
    <a href="./Pages/workout.html" class="hover:text-blue-500">Workouts</a>
    <a href="./Pages/mental.html" class="hover:text-blue-500">Mental Health</a>
    <a href="./Pages/community.html" class="hover:text-blue-500">Community</a>
    <a href="./Pages/weight.html" class="hover:text-blue-500">Weight</a>
  </div>
  <div>
    <img src="https://www.svgrepo.com/show/51234/user.svg" alt="Profile" class="w-8 h-8 rounded-full" />
  </div>
</nav>

<!-- Welcome Section -->
<section class="text-center py-10 px-4">
  <h1 class="text-4xl font-bold mb-2">Welcome to MetaFit</h1>
  <p class="text-lg text-gray-600">Your personal health and wellness dashboard</p>
</section>

<!-- Dashboard -->
<div class="max-w-7xl mx-auto p-6 grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
  <!-- Current Stats -->
  <div class="bg-white shadow rounded-2xl p-6">
    <h2 class="text-xl font-semibold mb-4">Your Progress</h2>
    <div class="space-y-6">
      <!-- Column: Name, Age, Height -->
      <div class="space-y-2 mb-10 mt-8">
        <p class="text-lg">üë§ <strong id="userName">Loading...</strong></p>
        <p class="text-lg">üßì <strong id="userAge">...</strong></p>
        <p class="text-lg">üìè <strong id="userHeight">...</strong></p>
      </div>

      <!-- Two Columns: Weight & Calorie -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 ">
        <div class="space-y-3">
          <p class="text-lg">‚öñÔ∏è <strong>Current Weight:</strong> <span id="currentWeight">...</span> kg</p>
          <p class="text-lg">üî• <strong>Current Calorie:</strong> <span id="currentCalorie">...</span> kcal</p>
        </div>
        <div class="space-y-3">
          <p class="text-lg">üéØ <strong>Target Weight:</strong> <span id="targetWeight">...</span> kg</p>
          <p class="text-lg">üéØ <strong>Target Calorie:</strong> <span id="targetCalorie">...</span> kcal</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Graph -->
  <div class="bg-white shadow rounded-2xl p-6">
    <h2 class="text-xl font-semibold mb-4">Weight Progress Graph</h2>
    <canvas id="weightChart" height="200"></canvas>
  </div>
</div>

<!-- Cards -->
<section class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 p-6 max-w-6xl mx-auto">
  <div id="meal" class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
    <h2 class="text-xl font-semibold mb-2">üçΩÔ∏è Meal Plans</h2>
    <p class="text-gray-600">Track calories, plan meals, and stay on track.</p>
  </div>
  <div id="workout" class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
    <h2 class="text-xl font-semibold mb-2">üí™ Workout Routines</h2>
    <p class="text-gray-600">Customized routines for your fitness goals.</p>
  </div>
  <div id="mental" class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
    <h2 class="text-xl font-semibold mb-2">üß† Mental Health</h2>
    <p class="text-gray-600">Mindfulness tools and mental check-ins.</p>
    <button onclick="alert('Mood Tracker coming soon!')" class="mt-2 text-blue-600 underline">Track Mood</button>
  </div>
  <div id="community" class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
    <h2 class="text-xl font-semibold mb-2">üë• Community</h2>
    <p class="text-gray-600">Join forums, share your journey, get support.</p>
    <a href="forum.html" class="mt-2 inline-block text-blue-600 underline">Go to Forum</a>
  </div>
  <div id="weight" class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
    <h2 class="text-xl font-semibold mb-2">‚öñÔ∏è Weight Tracker</h2>
    <p class="text-gray-600">Monitor your weight progress over time.</p>
  </div>
  <div id="calorie" class="bg-white rounded-2xl shadow p-6 hover:shadow-lg transition">
    <h2 class="text-xl font-semibold mb-2">üî• Calorie Calculator</h2>
    <p class="text-gray-600">Calculate your daily calorie needs based on your lifestyle.</p>
    <button onclick="openCalorieCalculator()" class="mt-3 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Try Now</button>
  </div>
</section>

<!-- Calorie Calculator Modal -->
<div id="calorie-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
  <div class="bg-white p-6 rounded-xl shadow-lg max-w-md w-full relative">
    <h3 class="text-lg font-bold mb-4">Calorie Calculator</h3>
    <div class="space-y-3">
      <label class="block">Age: <input type="number" id="age" class="w-full border p-2 rounded" /></label>
      <label class="block">Weight (kg): <input type="number" id="wweight" class="w-full border p-2 rounded" /></label>
      <label class="block">Height (cm): <input type="number" id="height" class="w-full border p-2 rounded" /></label>
      <label class="block">Activity Level:
        <select id="activity" class="w-full border p-2 rounded">
          <option value="1.2">Sedentary</option>
          <option value="1.375">Light</option>
          <option value="1.55">Moderate</option>
          <option value="1.725">Active</option>
          <option value="1.9">Very Active</option>
        </select>
      </label>
    </div>
    <div class="mt-4">
      <button onclick="calculateCalories()" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Calculate</button>
      <button onclick="closeCalorieCalculator()" class="ml-2 px-4 py-2 bg-gray-300 rounded hover:bg-gray-400">Close</button>
    </div>
    <p id="calorie-result" class="mt-4 font-medium text-blue-600"></p>
  </div>
</div>

<!-- Footer -->
<footer class="text-center py-6 mt-10 bg-white shadow-inner">
  <p class="text-sm">&copy; 2025 MetaFit. All rights reserved.</p>
  <div class="mt-2 text-sm text-blue-500 space-x-4">
    <a href="#meal" class="hover:underline">Meals</a>
    <a href="#workout" class="hover:underline">Workouts</a>
    <a href="#mental" class="hover:underline">Mental</a>
    <a href="#community" class="hover:underline">Community</a>
  </div>
</footer>


<!-- Chart Script -->
<script>
  const ctx = document.getElementById('weightChart').getContext('2d');
  const weightChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
      datasets: [
        {
          label: 'Weight (kg)',
          data: [75, 73, 72, 72],
          borderColor: '#3B82F6',
          backgroundColor: 'rgba(59, 130, 246, 0.1)',
          fill: true,
          tension: 0.4,
          pointRadius: 5,
        },
        {
          label: 'Current Calorie (kcal)',
          data: [2300, 2250, 2200, 2200],
          borderColor: '#10B981',
          backgroundColor: 'rgba(16, 185, 129, 0.1)',
          fill: true,
          tension: 0.4,
          pointRadius: 5,
        },
        {
          label: 'Target Calorie (kcal)',
          data: [2000, 2000, 2000, 2000],
          borderColor: '#F59E0B',
          backgroundColor: 'rgba(245, 158, 11, 0.1)',
          fill: false,
          borderDash: [5, 5],
          tension: 0.4,
          pointRadius: 5,
        }
      ],
    },
    options: {
      responsive: true,
      plugins: {
        legend: {
          display: true,
          labels: {
            color: '#1F2937'
          }
        }
      },
      scales: {
        y: {
          beginAtZero: false,
          ticks: {
            color: '#1F2937'
          }
        },
        x: {
          ticks: {
            color: '#1F2937'
          }
        }
      }
    }
  });
</script>

<!-- Keep this after your dashboard HTML -->
<div id="loginWarning" class="text-center text-red-600 font-semibold mt-4 hidden">
  You are not logged in. Please <a href="login.html" class="underline text-blue-600">log in</a>.
</div>

<script>
  async function fetchUserInfo() {
    const email = localStorage.getItem("userEmail");
    const warningBox = document.getElementById("loginWarning");

    if (!email) {
      warningBox.classList.remove("hidden");
      return;
    }

    try {
      const res = await fetch("http://localhost/metafit/api/get_user.php", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email }),
      });

      const data = await res.json();
      if (res.ok) {
        document.getElementById("userName").textContent = data.name;
        document.getElementById("userAge").textContent = `Age: ${data.age}`;
        document.getElementById("userHeight").textContent = `Height: ${data.height} cm`;
        document.getElementById("currentWeight").textContent = data.weight;
        document.getElementById("targetWeight").textContent = data.target_weight;
        document.getElementById("currentCalorie").textContent = data.calorie_current;
        document.getElementById("targetCalorie").textContent = data.calorie_target;
      } else {
        warningBox.textContent = "User not found.";
        warningBox.classList.remove("hidden");
      }
    } catch (error) {
      console.error("Fetch error:", error);
      warningBox.textContent = "An error occurred.";
      warningBox.classList.remove("hidden");
    }
  }

  fetchUserInfo();
</script>


</body>
</html>


